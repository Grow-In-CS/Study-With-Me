# ğŸ”‘ JSON Web Token (JWT)

---

## ğŸ“˜ 1. ê°œë… ìš”ì•½

**JWT (JSON Web Token)** ëŠ” ë‘ ì‹œìŠ¤í…œ ê°„ì— ì •ë³´ë¥¼ **JSON ê°ì²´ í˜•íƒœë¡œ ì•ˆì „í•˜ê²Œ ì „ì†¡í•˜ê¸° ìœ„í•œ í† í° í‘œì¤€**ì´ë‹¤.  
í† í° ìì²´ì— ì¸ì¦ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©°, **ì„œë²„ê°€ ì„¸ì…˜ì„ ìœ ì§€í•˜ì§€ ì•Šì•„ë„ ì‚¬ìš©ì ì¸ì¦ì´ ê°€ëŠ¥**í•˜ë‹¤.

> â€œJWTëŠ” ì‚¬ìš©ìì˜ ì¸ì¦ ì •ë³´ë¥¼ ì•”í˜¸í™”ëœ í† í° ì•ˆì— ë‹´ì•„ ì„œë²„ ê°„ ì¸ì¦ì„ ê°„ì†Œí™”í•˜ëŠ” ë°©ì‹ì´ë‹¤.â€

---

## ğŸ§  2. JWTì˜ êµ¬ì¡°

JWTëŠ” 3ê°œì˜ ë¶€ë¶„ìœ¼ë¡œ êµ¬ì„±ë˜ë©°, ê°ê° Base64URLë¡œ ì¸ì½”ë”©ë˜ì–´ `.` ìœ¼ë¡œ êµ¬ë¶„ëœë‹¤.

```
xxxxx.yyyyy.zzzzz
```

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2Fb0nX6m%2FbtsHIIWPhFw%2FAAAAAAAAAAAAAAAAAAAAAD7mvc4m6Vqj91zpHI2eGABfFyLHQjyyeiFIVbJ5GODI%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1764514799%26allow_ip%3D%26allow_referer%3D%26signature%3DgIYCsWxXsdePV%252BohpyvYG2DZrCs%253D)

| êµ¬ë¶„ | ì´ë¦„ | ì„¤ëª… |
|------|------|------|
| â‘  | **Header** | í† í° íƒ€ì…(`JWT`), ì„œëª… ì•Œê³ ë¦¬ì¦˜(`HS256`, `RS256` ë“±) |
| â‘¡ | **Payload** | ì‚¬ìš©ì ì •ë³´(Claims) |
| â‘¢ | **Signature** | Header + Payloadë¥¼ ë¹„ë°€í‚¤ë¡œ ì„œëª…í•œ ê°’ (ë¬´ê²°ì„± ë³´ì¥) |

ì˜ˆì‹œ:
```json
Header:  {"alg": "HS256", "typ": "JWT"}
Payload: {"sub": "12345", "name": "Jin-hyung Lee", "role": "user"}
```

ì¸ì½”ë”© í›„:
```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
.eyJzdWIiOiIxMjM0NSIsIm5hbWUiOiJKaW4taHl1bmciLCJyb2xlIjoidXNlciJ9
.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
```

---

## ğŸ§¾ 3. JWTì˜ êµ¬ì„± ìš”ì†Œ ìƒì„¸

### ğŸ”¹ Header
- í† í°ì˜ íƒ€ì…ê³¼ ì„œëª… ì•Œê³ ë¦¬ì¦˜ ì§€ì •
```json
{
  "alg": "HS256",
  "typ": "JWT"
}
```

### ğŸ”¹ Payload
- ì‚¬ìš©ì ì‹ë³„ ì •ë³´ì™€ í† í° ë§Œë£Œ ë“± í¬í•¨
- **í‘œì¤€ í´ë ˆì„(Registered Claims)** ê³¼ **ì‚¬ìš©ì ì •ì˜ í´ë ˆì„(Custom Claims)** ì¡´ì¬

| Claim | ì„¤ëª… |
|--------|------|
| `iss` | í† í° ë°œê¸‰ì (issuer) |
| `sub` | ì‚¬ìš©ì ì‹ë³„ì (subject) |
| `aud` | í† í° ëŒ€ìƒì (audience) |
| `exp` | ë§Œë£Œ ì‹œê°„ (expiration) |
| `iat` | ë°œê¸‰ ì‹œê°„ (issued at) |
| `nbf` | í† í°ì´ ìœ íš¨í•´ì§€ëŠ” ì‹œì‘ ì‹œì  (not before) |

ì˜ˆì‹œ:
```json
{
  "iss": "my-app",
  "sub": "user123",
  "exp": 1731187200,
  "role": "admin"
}
```

### ğŸ”¹ Signature
- ìœ„ë³€ì¡° ë°©ì§€ë¥¼ ìœ„í•œ ì„œëª…
```
HMACSHA256(
  base64UrlEncode(header) + "." + base64UrlEncode(payload),
  secret
)
```

---

## ğŸ”„ 4. JWT ì¸ì¦ ë™ì‘ íë¦„

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2Fqzckl%2FbtsHIaGkaAl%2FAAAAAAAAAAAAAAAAAAAAANwYxiWMLBqsJniB_GXPTQLf-LMwC6uN_r3nvDuX04Ab%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1764514799%26allow_ip%3D%26allow_referer%3D%26signature%3DmrxCxIyTPMDB6cCMgzyQPdGYQ1o%253D)

```
[1] í´ë¼ì´ì–¸íŠ¸ ë¡œê·¸ì¸ ìš”ì²­
       â†“
[2] ì„œë²„ì—ì„œ ì‚¬ìš©ì ì¸ì¦ í›„ JWT ë°œê¸‰
       â†“
[3] í´ë¼ì´ì–¸íŠ¸ëŠ” JWTë¥¼ ì €ì¥ (ë³´í†µ LocalStorage / Cookie)
       â†“
[4] API ìš”ì²­ ì‹œ Authorization í—¤ë”ì— JWT í¬í•¨
       â†“
[5] ì„œë²„ëŠ” ì„œëª… ê²€ì¦ í›„ ì ‘ê·¼ í—ˆìš©
```

ì˜ˆì‹œ ìš”ì²­:
```http
GET /user/info HTTP/1.1
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

---

## âš™ï¸ 5. JWT vs ì„¸ì…˜(Session) ë°©ì‹ ë¹„êµ

| í•­ëª© | JWT | ì„¸ì…˜ |
|------|------|------|
| ìƒíƒœ ê´€ë¦¬ | Stateless (ì„œë²„ ì €ì¥ X) | Stateful (ì„œë²„ ì €ì¥ O) |
| í™•ì¥ì„± | ì„œë²„ ë¶„ì‚°ì— ìœ ë¦¬ | ì„œë²„ ê°„ ì„¸ì…˜ ê³µìœ  í•„ìš” |
| ë³´ì•ˆ | í† í° íƒˆì·¨ ì‹œ ìœ„í—˜ | ì„¸ì…˜ ë§Œë£Œë¡œ ë¹„êµì  ì•ˆì „ |
| ì†ë„ | ë¹ ë¦„ (DB ì¡°íšŒ ë¶ˆí•„ìš”) | ëŠë¦¼ (ì„¸ì…˜ ì¡°íšŒ í•„ìš”) |
| ë§Œë£Œ ê´€ë¦¬ | í´ë¼ì´ì–¸íŠ¸ ì¸¡ ë§Œë£Œ | ì„œë²„ì—ì„œ ì§ì ‘ ê´€ë¦¬ |

---

## ğŸ§© 6. JWT ì €ì¥ ë°©ì‹

| ìœ„ì¹˜ | ì¥ì  | ë‹¨ì  |
|------|------|------|
| **LocalStorage** | ì‚¬ìš© í¸ë¦¬ | XSS ê³µê²©ì— ì·¨ì•½ |
| **Cookie (HttpOnly)** | ë³´ì•ˆ ë†’ìŒ | CSRF ê³µê²©ì— ì£¼ì˜ í•„ìš” |

---

## ğŸ” 7. JWT ì‚¬ìš© ì‹œ ë³´ì•ˆ ì£¼ì˜ì‚¬í•­

| ìœ„í—˜ ìš”ì†Œ | ì„¤ëª… | ëŒ€ì‘ì±… |
|------------|------|--------|
| **í† í° íƒˆì·¨** | í† í°ì´ ìœ ì¶œë˜ë©´ ëˆ„êµ¬ë‚˜ ì¸ì¦ ê°€ëŠ¥ | HTTPS, ì§§ì€ ë§Œë£Œ ì‹œê°„ |
| **ì„œëª… ê²€ì¦ ëˆ„ë½** | ì„œë²„ê°€ ì„œëª… ê²€ì¦ì„ ì•ˆ í•˜ë©´ ìœ„ë³€ì¡° ê°€ëŠ¥ | ë¹„ë°€í‚¤ë¡œ í•­ìƒ ê²€ì¦ |
| **ë§Œë£Œ ê´€ë¦¬ ë¯¸í¡** | ë¬´í•œíˆ ìœ íš¨í•œ í† í°ì€ ìœ„í—˜ | `exp` í•„ë“œ ì„¤ì • í•„ìˆ˜ |
| **XSS / CSRF ê³µê²©** | í† í° ì €ì¥ ìœ„ì¹˜ì— ë”°ë¥¸ ë³´ì•ˆ ìœ„í˜‘ | HttpOnly ì¿ í‚¤ ì‚¬ìš©, CSRF í† í° ë³‘í–‰ |

---

## ğŸ§° 8. JWT í™œìš© ì˜ˆì‹œ (Spring Boot)

```java
// JWT ìƒì„±
String token = Jwts.builder()
    .setSubject("user123")
    .setIssuedAt(new Date())
    .setExpiration(new Date(System.currentTimeMillis() + 3600000)) // 1ì‹œê°„
    .signWith(SignatureAlgorithm.HS256, secretKey)
    .compact();
```

```java
// JWT ê²€ì¦
Claims claims = Jwts.parser()
    .setSigningKey(secretKey)
    .parseClaimsJws(token)
    .getBody();

System.out.println(claims.getSubject()); // user123
```

---

## â˜ï¸ 9. JWT + OAuth2 í†µí•© êµ¬ì¡°

OAuth 2.0ì˜ **Access Token**ìœ¼ë¡œ **JWTë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°**ë„ ë§ë‹¤.  
ì˜ˆ: Google, AWS Cognito, Keycloak ë“±.

ì¥ì :
- ì„œëª… ê²€ì¦ìœ¼ë¡œ ì¦‰ì‹œ ìœ íš¨ì„± í™•ì¸ ê°€ëŠ¥
- ì¤‘ì•™ ì¸ì¦ ì„œë²„ ì—†ì´ ë¶„ì‚° ì¸ì¦ ê°€ëŠ¥

---

## ğŸš¨ 10. JWTì˜ í•œê³„ì 

| ë¬¸ì œì  | ì„¤ëª… |
|---------|------|
| í† í° íê¸° ì–´ë ¤ì›€ | ì„œë²„ëŠ” ì´ë¯¸ ë°œê¸‰ëœ í† í°ì„ ê°•ì œë¡œ ë¬´íš¨í™”í•˜ê¸° ì–´ë µë‹¤ |
| í† í° í¬ê¸° ì¦ê°€ | Payloadê°€ í´ìˆ˜ë¡ HTTP í—¤ë” ë¶€ë‹´ ì¦ê°€ |
| íƒˆì·¨ ì‹œ ìœ„í—˜ | í•œ ë²ˆ ìœ ì¶œë˜ë©´ ì„œë²„ ì°¨ì›ì—ì„œ ì œì–´ ë¶ˆê°€ |

---

## ğŸ§  11. í•µì‹¬ ìš”ì•½

- JWTëŠ” **Stateless ì¸ì¦ ë°©ì‹**ìœ¼ë¡œ ì„œë²„ ë¶€í•˜ë¥¼ ì¤„ì´ê³  í™•ì¥ì„± í–¥ìƒ
- êµ¬ì¡°: Header + Payload + Signature
- ë³´ì•ˆì„ ìœ„í•´ **HTTPS**, **ì§§ì€ ë§Œë£Œ**, **HttpOnly Cookie**, **Refresh Token ì „ëµ** í•„ìš”
- ì„¸ì…˜ ê´€ë¦¬ê°€ í•„ìš” ì—†ëŠ” ëŒ€ê·œëª¨ ë¶„ì‚° í™˜ê²½ì— ì í•©

---

ğŸ“˜ **References**
- [RFC 7519 - JSON Web Token](https://datatracker.ietf.org/doc/html/rfc7519)
- [Auth0 JWT Introduction](https://jwt.io/introduction/)
- [Spring Security JWT Guide](https://spring.io/guides/tutorials/spring-boot-oauth2/)
