# ğŸŒ CORS (Cross-Origin Resource Sharing)

---

## ğŸ“˜ 1. ê°œë… ìš”ì•½

**CORS (Cross-Origin Resource Sharing)**ë€,  
ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ **ë‹¤ë¥¸ ì¶œì²˜(origin)**ì˜ ë¦¬ì†ŒìŠ¤ ìš”ì²­ì„ ì œí•œí•˜ëŠ”  
**Same-Origin Policy(SOP)**ë¥¼ ì™„í™”í•˜ê¸° ìœ„í•œ **HTTP í‘œì¤€ ë©”ì»¤ë‹ˆì¦˜**ì´ë‹¤.

ì¦‰,
> í•œ ë„ë©”ì¸(ì¶œì²˜)ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´  
> ë‹¤ë¥¸ ë„ë©”ì¸(ì¶œì²˜)ì˜ ë¦¬ì†ŒìŠ¤(API ë“±)ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í—ˆìš©í•˜ëŠ” ê·œì¹™.

---

## ğŸ·ï¸ 2. ì¶œì²˜(Origin)ë€?

ì¶œì²˜(Origin)ëŠ” ì•„ë˜ ì„¸ ìš”ì†Œê°€ ëª¨ë‘ ë™ì¼í•´ì•¼ ê°™ì€ ì¶œì²˜ë¡œ ê°„ì£¼ëœë‹¤.

| êµ¬ì„± ìš”ì†Œ | ì˜ˆì‹œ |
|------------|------|
| í”„ë¡œí† ì½œ | `https://` |
| ë„ë©”ì¸ | `api.example.com` |
| í¬íŠ¸ | `:443` |

ì˜ˆë¥¼ ë“¤ì–´:

| ì£¼ì†Œ | ë¹„êµ | ë™ì¼ ì—¬ë¶€ |
|------|------|-----------|
| `https://example.com:443` | `https://example.com:443` | âœ… ë™ì¼ |
| `https://example.com` | `http://example.com` | âŒ í”„ë¡œí† ì½œ ë‹¤ë¦„ |
| `https://example.com` | `https://api.example.com` | âŒ ë„ë©”ì¸ ë‹¤ë¦„ |
| `https://example.com` | `https://example.com:8080` | âŒ í¬íŠ¸ ë‹¤ë¦„ |

---

## ğŸš« 3. Same-Origin Policyë€?

ì›¹ ë¸Œë¼ìš°ì €ëŠ” ë³´ì•ˆì„ ìœ„í•´ **ë‹¤ë¥¸ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ì„ ì œí•œ**í•œë‹¤.  
ì´ ì •ì±… ë•ë¶„ì— ì•…ì˜ì ì¸ ì‚¬ì´íŠ¸ê°€ ì„ì˜ë¡œ ë‹¤ë¥¸ ì‚¬ì´íŠ¸ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì„ ë°©ì§€í•œë‹¤.

ì˜ˆì‹œ:
```javascript
// ë‹¤ë¥¸ ë„ë©”ì¸ìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚¼ ë•Œ
fetch("https://api.other-domain.com/data")
  .then(res => res.json())
  .then(console.log);
```
ì´ ì½”ë“œëŠ” CORSê°€ í—ˆìš©ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ë¥¼ ë‚¸ë‹¤:
```
Access to fetch at 'https://api.other-domain.com/data' 
from origin 'https://my-domain.com' has been blocked by CORS policy.
```

---

## âœ… 4. CORS ë™ì‘ ì›ë¦¬

### 1ï¸âƒ£ ë‹¨ìˆœ ìš”ì²­(Simple Request)
- `GET`, `POST`, `HEAD` ì¤‘ í•˜ë‚˜ì˜ ë©”ì„œë“œ
- `Content-Type`ì´ `application/x-www-form-urlencoded`, `multipart/form-data`, `text/plain`
- ìš”ì²­ ì‹œ **Preflight(ì‚¬ì „ ìš”ì²­)** ì—†ì´ ë°”ë¡œ ìš”ì²­ì„ ì „ì†¡

### 2ï¸âƒ£ Preflight ìš”ì²­ (OPTIONS)
ë¸Œë¼ìš°ì €ê°€ ì‹¤ì œ ìš”ì²­ ì „ì— ë¨¼ì € `OPTIONS` ë©”ì„œë“œë¡œ ìš”ì²­ì„ ë³´ë‚´  
ì„œë²„ê°€ í•´ë‹¹ ì¶œì²˜ì˜ ì ‘ê·¼ì„ í—ˆìš©í•˜ëŠ”ì§€ í™•ì¸í•œë‹¤.

ì˜ˆì‹œ:
```http
OPTIONS /data HTTP/1.1
Origin: https://my-domain.com
Access-Control-Request-Method: POST
Access-Control-Request-Headers: Content-Type
```

ì„œë²„ ì‘ë‹µ:
```http
HTTP/1.1 204 No Content
Access-Control-Allow-Origin: https://my-domain.com
Access-Control-Allow-Methods: GET, POST, OPTIONS
Access-Control-Allow-Headers: Content-Type
Access-Control-Max-Age: 86400
```

ì´í›„ ë¸Œë¼ìš°ì €ëŠ” ì‹¤ì œ ìš”ì²­(`POST /data`)ì„ ë³´ë‚¸ë‹¤.

---

## ğŸ§© 5. ì„œë²„ ì¸¡ ì„¤ì • ì˜ˆì‹œ

### ğŸŸ¢ (1) Node.js (Express)
```javascript
import express from "express";
import cors from "cors";

const app = express();
app.use(cors()); // ëª¨ë“  ì¶œì²˜ í—ˆìš©

// íŠ¹ì • ì¶œì²˜ë§Œ í—ˆìš©
// app.use(cors({ origin: "https://my-domain.com" }));

app.get("/data", (req, res) => {
  res.json({ message: "Hello CORS!" });
});

app.listen(3000);
```

---

### ğŸŸ¢ (2) Spring Boot
```java
@RestController
@CrossOrigin(origins = "https://my-domain.com")
public class ApiController {
    @GetMapping("/data")
    public String data() {
        return "Hello CORS!";
    }
}
```

í˜¹ì€ ì „ì—­ ì„¤ì •:
```java
@Configuration
public class WebConfig implements WebMvcConfigurer {
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**")
                .allowedOrigins("https://my-domain.com")
                .allowedMethods("GET", "POST", "PUT", "DELETE")
                .allowCredentials(true);
    }
}
```

---

## âš™ï¸ 6. ì£¼ìš” í—¤ë” ì •ë¦¬

| í—¤ë” | ì„¤ëª… |
|------|------|
| `Access-Control-Allow-Origin` | í—ˆìš©í•  ì¶œì²˜ ì§€ì • (`*`ì€ ì „ì²´ í—ˆìš©) |
| `Access-Control-Allow-Methods` | í—ˆìš©í•  HTTP ë©”ì„œë“œ ì§€ì • |
| `Access-Control-Allow-Headers` | í—ˆìš©í•  ìš”ì²­ í—¤ë” ì§€ì • |
| `Access-Control-Allow-Credentials` | ì¿ í‚¤ ì „ì†¡ ì—¬ë¶€ (`true`ë¡œ ì„¤ì • ì‹œ `*` ì‚¬ìš© ë¶ˆê°€) |
| `Access-Control-Max-Age` | Preflight ê²°ê³¼ ìºì‹± ì‹œê°„(ì´ˆ) |

---

## ğŸ§  7. í•µì‹¬ ìš”ì•½

- ë¸Œë¼ìš°ì €ëŠ” **ë³´ì•ˆìƒ ê¸°ë³¸ì ìœ¼ë¡œ ë‹¤ë¥¸ ì¶œì²˜ ìš”ì²­ì„ ë§‰ëŠ”ë‹¤.**
- ì„œë²„ê°€ **ì ì ˆí•œ CORS í—¤ë”ë¥¼ ì‘ë‹µ**í•˜ë©´ í—ˆìš©ëœë‹¤.
- ê°œë°œ í™˜ê²½ì—ì„œëŠ” `cors()` ë¯¸ë“¤ì›¨ì–´ë‚˜ `@CrossOrigin`ìœ¼ë¡œ ì‰½ê²Œ í•´ê²° ê°€ëŠ¥.
- `Access-Control-Allow-Origin: *` ì€ ê°„í¸í•˜ì§€ë§Œ,  
  ë¯¼ê°í•œ ì •ë³´(ì¿ í‚¤ ë“±)ê°€ í¬í•¨ëœ ìš”ì²­ì—” ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€.

---

## ğŸ§­ 8. ì‹¤ì œ ì—ëŸ¬ í•´ê²° íŒ

| ìƒí™© | í•´ê²° ë°©ë²• |
|------|------------|
| `Access-Control-Allow-Origin` ëˆ„ë½ | ì„œë²„ì—ì„œ í•´ë‹¹ í—¤ë” ì¶”ê°€ |
| Credentials í¬í•¨ ì‹œ ì˜¤ë¥˜ | `Allow-Origin`ì— `*` ëŒ€ì‹  ì‹¤ì œ ë„ë©”ì¸ ëª…ì‹œ |
| Preflight OPTIONS ì‘ë‹µ ì—†ìŒ | ì„œë²„ê°€ OPTIONS ìš”ì²­ë„ ì²˜ë¦¬í•˜ë„ë¡ ìˆ˜ì • |
| ë¡œì»¬ ê°œë°œ ì‹œ ì°¨ë‹¨ | `proxy`, `devServer.proxy` ë“±ìœ¼ë¡œ í”„ë¡ì‹œ ì„¤ì • |

---

ğŸ“˜ **Reference**
- [MDN Web Docs - CORS](https://developer.mozilla.org/ko/docs/Web/HTTP/CORS)
- [Fetch Standard - WHATWG](https://fetch.spec.whatwg.org/#http-cors-protocol)

---
